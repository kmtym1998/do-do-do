html lang="ja"
    head
        meta charset="UTF-8"/
        meta name="viewport" content="width=device-width, initial-scale=1.0"/
        title Document
        script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"
        script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"
        / 本番環境 script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"
    body
        div#vm-container
            header

            main
                h1 タスク一覧

                = form_with url: home_ajax_create_path do |f|
                    = f.text_field :taskTitle, class: "input-task-title", "v-model": "newTaskTitle"
                    = f.submit '完了', class: "submit-task-title", "@click": "submitNewTask"
                
                / input class="input-task-title" type="text" v-model="taskTitle"
                / input class="submit-task-title" type="submit" @click="submitNewTask"

                div#tasks-container
                    -@tasks.reverse_each do |task|
                        li.task-title @click="editTask" = task.title

                div.modal-close#modal-background @click="hideModal"

                div.modal#modal-edit
                    div.modal-content#modal-edit-content
                        = form_with url: home_ajax_edit_path do |f|
                            = f.text_field :taskTitle, class: "input-edit", placeholder: "タスク名", "v-model": "edittingTask.taskTitle"
                            = f.datetime_field :deadline, class: "input-edit", "v-model": "edittingTask.deadline"
                            = f.select :priority, [["低", 0], ["中", 1], ["高", 2]], "v-model": "edittingTask.priority"
                            = f.select :state, [["未着手", 0], ["着手", 1], ["完了", 2]], "v-model": "edittingTask.state"
                            = f.text_area :memo, class: "input-edit", "v-model": "edittingTask.memo"
                            = f.submit '完了', class: "submit-task-title", "@click": "submitEditedTask"

            footer


    javascript:
        const vm = new Vue({
            el: '#vm-container',
            data: {
                newTaskTitle: '',
                edittingTask: {
                    taskTitle: '',
                    deadline: '',
                    priority: '',
                    state: '',
                    memo: ''
                }
            },
            methods: {
                showModal: function(){
                    console.log('A click has been detected')
                },
                submitNewTask: function(){
                    console.log(this.newTaskTitle);
                },
                submitEditedTask: function(){
                    this.hideModal();
                    this.edittingTask.taskTitle = '';
                    this.edittingTask.deadline = '';
                    this.edittingTask.priority = '';
                    this.edittingTask.state = '';
                    this.edittingTask.memo = '';
                },
                editTask: function(){
                    this.showModal($('#modal-edit'));
                },
                showModal: function($target){
                    $($target).fadeIn();
                    $('#modal-background').fadeIn();
                    $('body').css('overflow', 'hidden');
                },
                hideModal: function(){
                    $('.modal').fadeOut();
                    $('#modal-background').fadeOut();
                    $('body').css('overflow', '');
                }
            }
        });